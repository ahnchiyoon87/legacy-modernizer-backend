{
  "prompts": {
    "prompt/understand_ddl.py": [
      {
        "timestamp": "2025-11-06T01:45:30.801297Z",
        "prompt": "prompt/understand_ddl.py",
        "input": {
          "ddl_content": "-- 환자 테이블\nCREATE TABLE TPJ_PATIENT (\n    PATIENT_KEY   VARCHAR2(10) PRIMARY KEY,   -- 환자키\n    PATIENT_NAME  VARCHAR2(50) NOT NULL,      -- 환자명\n    BIRTH_DATE    DATE NOT NULL,              -- 생년월일\n    GENDER        CHAR(1) NOT NULL,           -- 성별(M:남성/F:여성)\n    PHONE         VARCHAR2(20) NOT NULL,      -- 연락처\n    REG_DATE      DATE DEFAULT SYSDATE        -- 등록일자\n);\n\n\n-- 진료접수 테이블\nCREATE TABLE TPJ_RECEPTION (\n    RECEPT_KEY    VARCHAR2(20) PRIMARY KEY,   -- 접수키\n    PATIENT_KEY   VARCHAR2(10) NOT NULL,      -- 환자키\n    DEPT_CODE     VARCHAR2(10) NOT NULL,      -- 진료과코드(IM:내과/GS:외과/OS:정형외과)\n    SYMPTOM       VARCHAR2(500),              -- 증상\n    RECEPT_DATE   DATE DEFAULT SYSDATE,       -- 접수일시\n    STATUS        CHAR(1) NOT NULL,           -- 상태(W:대기/C:완료/X:취소)\n    FOREIGN KEY (PATIENT_KEY) REFERENCES TPJ_PATIENT(PATIENT_KEY)\n);",
          "locale": "ko"
        },
        "output": {
          "analysis": [
            {
              "table": {
                "schema": "",
                "name": "TPJ_PATIENT",
                "table_type": "BASE TABLE",
                "comment": "환자 테이블"
              },
              "columns": [
                {
                  "name": "PATIENT_KEY",
                  "dtype": "VARCHAR2(10)",
                  "nullable": false,
                  "comment": "환자키"
                },
                {
                  "name": "PATIENT_NAME",
                  "dtype": "VARCHAR2(50)",
                  "nullable": false,
                  "comment": "환자명"
                },
                {
                  "name": "BIRTH_DATE",
                  "dtype": "DATE",
                  "nullable": false,
                  "comment": "생년월일"
                },
                {
                  "name": "GENDER",
                  "dtype": "CHAR(1)",
                  "nullable": false,
                  "comment": "성별(M:남성/F:여성)"
                },
                {
                  "name": "PHONE",
                  "dtype": "VARCHAR2(20)",
                  "nullable": false,
                  "comment": "연락처"
                },
                {
                  "name": "REG_DATE",
                  "dtype": "DATE",
                  "nullable": true,
                  "comment": "등록일자"
                }
              ],
              "primaryKeys": [
                "PATIENT_KEY"
              ],
              "foreignKeys": []
            },
            {
              "table": {
                "schema": "",
                "name": "TPJ_RECEPTION",
                "table_type": "BASE TABLE",
                "comment": "진료접수 테이블"
              },
              "columns": [
                {
                  "name": "RECEPT_KEY",
                  "dtype": "VARCHAR2(20)",
                  "nullable": false,
                  "comment": "접수키"
                },
                {
                  "name": "PATIENT_KEY",
                  "dtype": "VARCHAR2(10)",
                  "nullable": false,
                  "comment": "환자키"
                },
                {
                  "name": "DEPT_CODE",
                  "dtype": "VARCHAR2(10)",
                  "nullable": false,
                  "comment": "진료과코드(IM:내과/GS:외과/OS:정형외과)"
                },
                {
                  "name": "SYMPTOM",
                  "dtype": "VARCHAR2(500)",
                  "nullable": true,
                  "comment": "증상"
                },
                {
                  "name": "RECEPT_DATE",
                  "dtype": "DATE",
                  "nullable": true,
                  "comment": "접수일시"
                },
                {
                  "name": "STATUS",
                  "dtype": "CHAR(1)",
                  "nullable": false,
                  "comment": "상태(W:대기/C:완료/X:취소)"
                }
              ],
              "primaryKeys": [
                "RECEPT_KEY"
              ],
              "foreignKeys": [
                {
                  "column": "PATIENT_KEY",
                  "ref": ".TPJ_PATIENT.PATIENT_KEY"
                }
              ]
            }
          ]
        },
        "tokenUsage": {
          "prompt": 763,
          "completion": 570,
          "total": 1333
        },
        "metadata": {
          "type": "ddl_analysis"
        }
      }
    ],
    "prompt/understand_variables_prompt.py": [
      {
        "timestamp": "2025-11-06T01:45:45.890294Z",
        "prompt": "prompt/understand_variables_prompt.py",
        "input": {
          "declaration_code": "1: 1: CREATE OR REPLACE PROCEDURE TPX_HOSPITAL_RECEPTION(\n2: 2:     pActionType     IN VARCHAR2,        -- 작업 유형(REGISTER:접수/CANCEL:취소/COMPLETE:완료)\n3: 3:     pPatientKey     IN VARCHAR2,        -- 환자키\n4: 4:     pPatientName    IN VARCHAR2 DEFAULT NULL,  -- 환자명(신규 환자)\n5: 5:     pBirthDate      IN DATE DEFAULT NULL,      -- 생년월일(신규 환자)\n6: 6:     pGender         IN CHAR DEFAULT NULL,      -- 성별(신규 환자)\n7: 7:     pPhone          IN VARCHAR2 DEFAULT NULL,  -- 연락처(신규 환자)\n8: 8:     pDeptCode       IN VARCHAR2 DEFAULT NULL,  -- 진료과코드\n9: 9:     pSymptom        IN VARCHAR2 DEFAULT NULL,  -- 증상\n10: 10:     pReceptKey      IN OUT VARCHAR2,           -- 접수키\n11: 11:     pResultCode     OUT NUMBER,                -- 결과 코드(0:성공)\n12: 12:     pResultMessage  OUT VARCHAR2               -- 결과 메시지\n13: 13: ) IS",
          "locale": "ko"
        },
        "output": {
          "variables": [
            {
              "name": "pActionType",
              "type": "VARCHAR2",
              "value": "None",
              "parameter_type": "IN"
            },
            {
              "name": "pPatientKey",
              "type": "VARCHAR2",
              "value": "None",
              "parameter_type": "IN"
            },
            {
              "name": "pPatientName",
              "type": "VARCHAR2",
              "value": "NULL",
              "parameter_type": "IN"
            },
            {
              "name": "pBirthDate",
              "type": "DATE",
              "value": "NULL",
              "parameter_type": "IN"
            },
            {
              "name": "pGender",
              "type": "CHAR",
              "value": "NULL",
              "parameter_type": "IN"
            },
            {
              "name": "pPhone",
              "type": "VARCHAR2",
              "value": "NULL",
              "parameter_type": "IN"
            },
            {
              "name": "pDeptCode",
              "type": "VARCHAR2",
              "value": "NULL",
              "parameter_type": "IN"
            },
            {
              "name": "pSymptom",
              "type": "VARCHAR2",
              "value": "NULL",
              "parameter_type": "IN"
            },
            {
              "name": "pReceptKey",
              "type": "VARCHAR2",
              "value": "None",
              "parameter_type": "IN_OUT"
            },
            {
              "name": "pResultCode",
              "type": "NUMBER",
              "value": "None",
              "parameter_type": "OUT"
            },
            {
              "name": "pResultMessage",
              "type": "VARCHAR2",
              "value": "None",
              "parameter_type": "OUT"
            }
          ],
          "summary": "이 프로시저는 환자 접수 관련 정보를 처리하기 위한 파라미터(입력, 출력, 입출력)를 선언하고 있습니다. 커서나 로컬 변수 선언은 포함되어 있지 않습니다."
        },
        "tokenUsage": {
          "prompt": 1208,
          "completion": 457,
          "total": 1665
        },
        "metadata": {
          "type": "variable_extraction"
        }
      },
      {
        "timestamp": "2025-11-06T01:45:45.898139Z",
        "prompt": "prompt/understand_variables_prompt.py",
        "input": {
          "declaration_code": "14: 14:     vPatientExists NUMBER;\n15: 15:     vReceptExists NUMBER;\n16: 16:     vReceptStatus CHAR(1);",
          "locale": "ko"
        },
        "output": {
          "variables": [
            {
              "name": "vPatientExists",
              "type": "NUMBER",
              "value": "None",
              "parameter_type": "LOCAL"
            },
            {
              "name": "vReceptExists",
              "type": "NUMBER",
              "value": "None",
              "parameter_type": "LOCAL"
            },
            {
              "name": "vReceptStatus",
              "type": "CHAR",
              "value": "None",
              "parameter_type": "LOCAL"
            }
          ],
          "summary": "로컬 변수로 환자 존재 여부, 접수 존재 여부, 접수 상태를 저장하는 변수들이 선언되어 있습니다."
        },
        "tokenUsage": {
          "prompt": 951,
          "completion": 151,
          "total": 1102
        },
        "metadata": {
          "type": "variable_extraction"
        }
      }
    ],
    "prompt/understand_prompt.py": [
      {
        "timestamp": "2025-11-06T01:45:47.454748Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "19: 19:     pResultCode := 0;\n\n20: 20:     pResultMessage := '성공적으로 처리되었습니다.';\n\n23: 23:     SELECT COUNT(*) INTO vPatientExists\n24: 24:     FROM TPJ_PATIENT\n25: 25:     WHERE PATIENT_KEY = pPatientKey;\n\n30: 30:             pResultCode := -1;\n\n31: 31:             pResultMessage := '신규 환자 정보가 부족합니다.';\n\n32: 32:             RETURN;",
          "ranges": [
            {
              "startLine": 19,
              "endLine": 19
            },
            {
              "startLine": 20,
              "endLine": 20
            },
            {
              "startLine": 23,
              "endLine": 25
            },
            {
              "startLine": 30,
              "endLine": 30
            },
            {
              "startLine": 31,
              "endLine": 31
            },
            {
              "startLine": 32,
              "endLine": 32
            }
          ],
          "count": 6,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 19,\\n      \"endLine\": 19,\\n      \"summary\": \"pResultCode 변수에 0을 할당하여 결과 코드가 정상임을 초기화합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultCode\"]\\n    },\\n    {\\n      \"startLine\": 20,\\n      \"endLine\": 20,\\n      \"summary\": \"pResultMessage 변수에 \\'성공적으로 처리되었습니다.\\'라는 메시지를 할당하여 기본 성공 메시지를 설정합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    },\\n    {\\n      \"startLine\": 23,\\n      \"endLine\": 25,\\n      \"summary\": \"TPJ_PATIENT 테이블에서 PATIENT_KEY가 pPatientKey와 일치하는 행의 개수를 조회하여 vPatientExists 변수에 저장합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"vPatientExists\", \"pPatientKey\"]\\n    },\\n    {\\n      \"startLine\": 30,\\n      \"endLine\": 30,\\n      \"summary\": \"pResultCode 변수에 -1을 할당하여 오류 또는 실패 상태를 표시합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultCode\"]\\n    },\\n    {\\n      \"startLine\": 31,\\n      \"endLine\": 31,\\n      \"summary\": \"pResultMessage 변수에 \\'신규 환자 정보가 부족합니다.\\'라는 오류 메시지를 할당합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    },\\n    {\\n      \"startLine\": 32,\\n      \"endLine\": 32,\\n      \"summary\": \"RETURN 문을 사용하여 프로시저 실행을 즉시 종료합니다.\",\\n      \"calls\": [],\\n      \"variables\": []\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 379, 'prompt_tokens': 1528, 'total_tokens': 1907, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYPb0gTK6RHFbHknb3PtUjLKZMdAk', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--61536fd0-22f3-40aa-bb76-d985ffb9534b-0' usage_metadata={'input_tokens': 1528, 'output_tokens': 379, 'total_tokens': 1907, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1528,
          "completion": 379,
          "total": 1907
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 19,
              "endLine": 19
            },
            {
              "startLine": 20,
              "endLine": 20
            },
            {
              "startLine": 23,
              "endLine": 25
            },
            {
              "startLine": 30,
              "endLine": 30
            },
            {
              "startLine": 31,
              "endLine": 31
            },
            {
              "startLine": 32,
              "endLine": 32
            }
          ],
          "startLine": 19,
          "endLine": 32
        },
        "sortKey": 19
      },
      {
        "timestamp": "2025-11-06T01:45:51.388828Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "28: 28:     IF vPatientExists = 0 AND pActionType = 'REGISTER' THEN\n29~33: pPatientName, pBirthDate, pGender, pPhone 중 하나라도 NULL이면 pResultCode에 -1을 할당하고, pResultMessage에 '신규 환자 정보가 부족합니다.'라는 메시지를 설정한 후 RETURN으로 프로시저 실행을 즉시 종료합니다.\n34: 34:         \n35: 35:         -- 환자 등록\n36~37: TPJ_PATIENT 테이블에 pPatientKey, pPatientName, pBirthDate, pGender, pPhone 값을 신규 환자 데이터로 삽입합니다.\n38~41: vPatientExists가 0일 때, pResultCode에 -2를 할당하여 오류 상태를 표시하고, pResultMessage에 '존재하지 않는 환자입니다:'와 pPatientKey 값을 결합해 상세 오류 메시지를 설정한 후, RETURN으로 프로시저 실행을 즉시 종료합니다.\n42: 42:     END IF;",
          "ranges": [
            {
              "startLine": 28,
              "endLine": 42
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 28,\\n      \"endLine\": 42,\\n      \"summary\": \"vPatientExists가 0이고 pActionType이 \\'REGISTER\\'일 때 신규 환자 등록 로직을 수행합니다. pPatientName, pBirthDate, pGender, pPhone 중 하나라도 NULL이면 pResultCode에 -1, pResultMessage에 \\'신규 환자 정보가 부족합니다.\\'를 설정하고 즉시 종료합니다. 모든 정보가 있으면 TPJ_PATIENT 테이블에 pPatientKey, pPatientName, pBirthDate, pGender, pPhone을 삽입합니다. 이후에도 vPatientExists가 0이면 pResultCode에 -2, pResultMessage에 \\'존재하지 않는 환자입니다:\\'와 pPatientKey를 결합해 오류 메시지를 설정하고 즉시 종료합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\\n        \"vPatientExists\",\\n        \"pActionType\",\\n        \"pPatientName\",\\n        \"pBirthDate\",\\n        \"pGender\",\\n        \"pPhone\",\\n        \"pResultCode\",\\n        \"pResultMessage\",\\n        \"pPatientKey\"\\n      ]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 253, 'prompt_tokens': 1567, 'total_tokens': 1820, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_144ea3b974', 'id': 'chatcmpl-CYRkKxcIeIwrdpADpiad7AYPOEyIT', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--c2dc2e59-7d56-42ae-bca3-c0705406bec1-0' usage_metadata={'input_tokens': 1567, 'output_tokens': 253, 'total_tokens': 1820, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1567,
          "completion": 253,
          "total": 1820
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 28,
              "endLine": 42
            }
          ],
          "startLine": 28,
          "endLine": 42
        },
        "sortKey": 28
      },
      {
        "timestamp": "2025-11-06T01:45:48.462289Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "29: 29:         IF pPatientName IS NULL OR pBirthDate IS NULL OR pGender IS NULL OR pPhone IS NULL THEN\n30~30: pResultCode 변수에 -1을 할당하여 오류 또는 실패 상태를 표시합니다.\n31~31: pResultMessage 변수에 '신규 환자 정보가 부족합니다.'라는 오류 메시지를 할당합니다.\n32~32: RETURN 문을 사용하여 프로시저 실행을 즉시 종료합니다.\n33: 33:         END IF;",
          "ranges": [
            {
              "startLine": 29,
              "endLine": 33
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 29,\\n      \"endLine\": 33,\\n      \"summary\": \"pPatientName, pBirthDate, pGender, pPhone 중 하나라도 NULL이면 pResultCode에 -1을 할당하고, pResultMessage에 \\'신규 환자 정보가 부족합니다.\\'라는 메시지를 설정한 후 RETURN으로 프로시저 실행을 즉시 종료합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pPatientName\", \"pBirthDate\", \"pGender\", \"pPhone\", \"pResultCode\", \"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 132, 'prompt_tokens': 1452, 'total_tokens': 1584, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_144ea3b974', 'id': 'chatcmpl-CYRkE9ccAUReJ789pb6197SQI2MvD', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--404e1fd4-7622-470e-8576-20b96be31a3d-0' usage_metadata={'input_tokens': 1452, 'output_tokens': 132, 'total_tokens': 1584, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1452,
          "completion": 132,
          "total": 1584
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 29,
              "endLine": 33
            }
          ],
          "startLine": 29,
          "endLine": 33
        },
        "sortKey": 29
      },
      {
        "timestamp": "2025-11-06T01:45:47.444950Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "36: 36:         INSERT INTO TPJ_PATIENT (PATIENT_KEY, PATIENT_NAME, BIRTH_DATE, GENDER, PHONE)\n37: 37:         VALUES (pPatientKey, pPatientName, pBirthDate, pGender, pPhone);\n\n39: 39:         pResultCode := -2;\n\n40: 40:         pResultMessage := '존재하지 않는 환자입니다: ' || pPatientKey;\n\n41: 41:         RETURN;",
          "ranges": [
            {
              "startLine": 36,
              "endLine": 37
            },
            {
              "startLine": 39,
              "endLine": 39
            },
            {
              "startLine": 40,
              "endLine": 40
            },
            {
              "startLine": 41,
              "endLine": 41
            }
          ],
          "count": 4,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 36,\\n      \"endLine\": 37,\\n      \"summary\": \"TPJ_PATIENT 테이블에 pPatientKey, pPatientName, pBirthDate, pGender, pPhone 값을 신규 환자 데이터로 삽입합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pPatientKey\", \"pPatientName\", \"pBirthDate\", \"pGender\", \"pPhone\"]\\n    },\\n    {\\n      \"startLine\": 39,\\n      \"endLine\": 39,\\n      \"summary\": \"pResultCode 변수에 -2 값을 할당하여 오류 또는 특정 상태를 표시합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultCode\"]\\n    },\\n    {\\n      \"startLine\": 40,\\n      \"endLine\": 40,\\n      \"summary\": \"pResultMessage 변수에 \\'존재하지 않는 환자입니다:\\'와 pPatientKey 값을 결합하여 오류 메시지를 설정합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\", \"pPatientKey\"]\\n    },\\n    {\\n      \"startLine\": 41,\\n      \"endLine\": 41,\\n      \"summary\": \"RETURN 문을 통해 프로시저 또는 함수의 실행을 즉시 종료합니다.\",\\n      \"calls\": [],\\n      \"variables\": []\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 283, 'prompt_tokens': 1488, 'total_tokens': 1771, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYPb00OSZ8oo7piFVMGqw9UXN9CEs', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--f572b927-4ed7-4f86-bace-f5305b37d431-0' usage_metadata={'input_tokens': 1488, 'output_tokens': 283, 'total_tokens': 1771, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1488,
          "completion": 283,
          "total": 1771
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 36,
              "endLine": 37
            },
            {
              "startLine": 39,
              "endLine": 39
            },
            {
              "startLine": 40,
              "endLine": 40
            },
            {
              "startLine": 41,
              "endLine": 41
            }
          ],
          "startLine": 36,
          "endLine": 41
        },
        "sortKey": 36
      },
      {
        "timestamp": "2025-11-06T01:45:50.053785Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "38: 38:     ELSIF vPatientExists = 0 THEN\n39~39: pResultCode 변수에 -2 값을 할당하여 오류 또는 특정 상태를 표시합니다.\n40~40: pResultMessage 변수에 '존재하지 않는 환자입니다:'와 pPatientKey 값을 결합하여 오류 메시지를 설정합니다.\n41~41: RETURN 문을 통해 프로시저 또는 함수의 실행을 즉시 종료합니다.",
          "ranges": [
            {
              "startLine": 38,
              "endLine": 41
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 38,\\n      \"endLine\": 41,\\n      \"summary\": \"vPatientExists가 0일 때, pResultCode에 -2를 할당하여 오류 상태를 표시하고, pResultMessage에 \\'존재하지 않는 환자입니다:\\'와 pPatientKey 값을 결합해 상세 오류 메시지를 설정한 후, RETURN으로 프로시저 실행을 즉시 종료합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"vPatientExists\", \"pResultCode\", \"pResultMessage\", \"pPatientKey\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 129, 'prompt_tokens': 1437, 'total_tokens': 1566, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_144ea3b974', 'id': 'chatcmpl-CYRkIinVPkfy6tcjsEtF32OenEIpK', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--d31ae607-793b-4b51-bf4d-b0cfc92bfd54-0' usage_metadata={'input_tokens': 1437, 'output_tokens': 129, 'total_tokens': 1566, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1437,
          "completion": 129,
          "total": 1566
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 38,
              "endLine": 41
            }
          ],
          "startLine": 38,
          "endLine": 41
        },
        "sortKey": 38
      },
      {
        "timestamp": "2025-11-06T01:45:52.528915Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "45: 45:     IF pActionType = 'REGISTER' THEN\n46~50: pDeptCode가 NULL인 경우 pResultCode에 -3을 할당하고, pResultMessage에 '진료과 코드가 필요합니다.'라는 안내 메시지를 설정한 뒤, RETURN으로 프로시저 실행을 즉시 종료합니다.\n51: 51:         \n52~52: pReceptKey가 NULL인 경우 SYS_GUID() 값을 할당하여 고유 접수키를 생성합니다.\n53: 53:         \n54~55: TPJ_RECEPTION 테이블에 pReceptKey, pPatientKey, pDeptCode, pSymptom, 'W' 값을 삽입하여 진료 접수 정보를 등록합니다.\n56: 56:         \n57~57: pResultMessage 변수에 '진료 접수가 완료되었습니다.'라는 메시지를 할당합니다.\n58: 58:     END IF;",
          "ranges": [
            {
              "startLine": 45,
              "endLine": 58
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 45,\\n      \"endLine\": 58,\\n      \"summary\": \"pActionType이 \\'REGISTER\\'인 경우 진료 접수 등록을 처리하며, pDeptCode가 없으면 오류 코드와 메시지를 반환하고 즉시 종료합니다. pReceptKey가 없으면 SYS_GUID()로 고유 키를 생성하고, TPJ_RECEPTION 테이블에 접수 정보를 삽입합니다. 성공 시 결과 메시지를 설정합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pActionType\", \"pDeptCode\", \"pResultCode\", \"pResultMessage\", \"pReceptKey\", \"pPatientKey\", \"pSymptom\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 156, 'prompt_tokens': 1538, 'total_tokens': 1694, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYRkQ3ek4L87E4GbeuNUIAJPsnISa', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--0badc221-77f0-4c43-9c9d-b315caf4935c-0' usage_metadata={'input_tokens': 1538, 'output_tokens': 156, 'total_tokens': 1694, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1538,
          "completion": 156,
          "total": 1694
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 45,
              "endLine": 58
            }
          ],
          "startLine": 45,
          "endLine": 58
        },
        "sortKey": 45
      },
      {
        "timestamp": "2025-11-06T01:45:52.083831Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "46: 46:         IF pDeptCode IS NULL THEN\n47~47: pResultCode 변수에 -3 값을 할당하여 오류 또는 특정 상태를 나타냅니다.\n48~48: pResultMessage 변수에 '진료과 코드가 필요합니다.'라는 메시지를 할당하여 오류 원인 또는 안내 메시지를 설정합니다.\n49~49: RETURN 문을 사용하여 프로시저 또는 함수의 실행을 즉시 종료합니다.\n50: 50:         END IF;",
          "ranges": [
            {
              "startLine": 46,
              "endLine": 50
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 46,\\n      \"endLine\": 50,\\n      \"summary\": \"pDeptCode가 NULL인 경우 pResultCode에 -3을 할당하고, pResultMessage에 \\'진료과 코드가 필요합니다.\\'라는 안내 메시지를 설정한 뒤, RETURN으로 프로시저 실행을 즉시 종료합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pDeptCode\", \"pResultCode\", \"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 109, 'prompt_tokens': 1447, 'total_tokens': 1556, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYRkOmR3ZSMcs3H75Bn5x94Sue9hm', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--9c2d5e72-9816-4bdf-9000-9a89fc7ae688-0' usage_metadata={'input_tokens': 1447, 'output_tokens': 109, 'total_tokens': 1556, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1447,
          "completion": 109,
          "total": 1556
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 46,
              "endLine": 50
            }
          ],
          "startLine": 46,
          "endLine": 50
        },
        "sortKey": 46
      },
      {
        "timestamp": "2025-11-06T01:45:47.448701Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "47: 47:             pResultCode := -3;\n\n48: 48:             pResultMessage := '진료과 코드가 필요합니다.';\n\n49: 49:             RETURN;",
          "ranges": [
            {
              "startLine": 47,
              "endLine": 47
            },
            {
              "startLine": 48,
              "endLine": 48
            },
            {
              "startLine": 49,
              "endLine": 49
            }
          ],
          "count": 3,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 47,\\n      \"endLine\": 47,\\n      \"summary\": \"pResultCode 변수에 -3 값을 할당하여 오류 또는 특정 상태를 나타냅니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultCode\"]\\n    },\\n    {\\n      \"startLine\": 48,\\n      \"endLine\": 48,\\n      \"summary\": \"pResultMessage 변수에 \\'진료과 코드가 필요합니다.\\'라는 메시지를 할당하여 오류 원인 또는 안내 메시지를 설정합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    },\\n    {\\n      \"startLine\": 49,\\n      \"endLine\": 49,\\n      \"summary\": \"RETURN 문을 사용하여 프로시저 또는 함수의 실행을 즉시 종료합니다.\",\\n      \"calls\": [],\\n      \"variables\": []\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 190, 'prompt_tokens': 1413, 'total_tokens': 1603, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYPb0ARok7NCkWx8n4OyDsgHsrCl8', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--3a90ca00-a3a6-4362-922a-889c0d064678-0' usage_metadata={'input_tokens': 1413, 'output_tokens': 190, 'total_tokens': 1603, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1413,
          "completion": 190,
          "total": 1603
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 47,
              "endLine": 47
            },
            {
              "startLine": 48,
              "endLine": 48
            },
            {
              "startLine": 49,
              "endLine": 49
            }
          ],
          "startLine": 47,
          "endLine": 49
        },
        "sortKey": 47
      },
      {
        "timestamp": "2025-11-06T01:45:47.465922Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "52: 52:         pReceptKey := NVL(pReceptKey, SYS_GUID());\n\n54: 54:         INSERT INTO TPJ_RECEPTION (RECEPT_KEY, PATIENT_KEY, DEPT_CODE, SYMPTOM, STATUS)\n55: 55:         VALUES (pReceptKey, pPatientKey, pDeptCode, pSymptom, 'W');\n\n57: 57:         pResultMessage := '진료 접수가 완료되었습니다.';",
          "ranges": [
            {
              "startLine": 52,
              "endLine": 52
            },
            {
              "startLine": 54,
              "endLine": 55
            },
            {
              "startLine": 57,
              "endLine": 57
            }
          ],
          "count": 3,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 52,\\n      \"endLine\": 52,\\n      \"summary\": \"pReceptKey가 NULL인 경우 SYS_GUID() 값을 할당하여 고유 접수키를 생성합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pReceptKey\"]\\n    },\\n    {\\n      \"startLine\": 54,\\n      \"endLine\": 55,\\n      \"summary\": \"TPJ_RECEPTION 테이블에 pReceptKey, pPatientKey, pDeptCode, pSymptom, \\'W\\' 값을 삽입하여 진료 접수 정보를 등록합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pReceptKey\", \"pPatientKey\", \"pDeptCode\", \"pSymptom\"]\\n    },\\n    {\\n      \"startLine\": 57,\\n      \"endLine\": 57,\\n      \"summary\": \"pResultMessage 변수에 \\'진료 접수가 완료되었습니다.\\'라는 메시지를 할당합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 227, 'prompt_tokens': 1472, 'total_tokens': 1699, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_144ea3b974', 'id': 'chatcmpl-CYPb0s7pi9w9BHoCENSojzlguoZfk', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--4e0ba6b4-a37d-490b-9b7b-de4c7ad42ce3-0' usage_metadata={'input_tokens': 1472, 'output_tokens': 227, 'total_tokens': 1699, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1472,
          "completion": 227,
          "total": 1699
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 52,
              "endLine": 52
            },
            {
              "startLine": 54,
              "endLine": 55
            },
            {
              "startLine": 57,
              "endLine": 57
            }
          ],
          "startLine": 52,
          "endLine": 57
        },
        "sortKey": 52
      },
      {
        "timestamp": "2025-11-06T01:45:54.449770Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "61: 61:     IF pActionType = 'CANCEL' THEN\n62~64: TPJ_RECEPTION 테이블에서 RECEPT_KEY와 PATIENT_KEY가 각각 pReceptKey, pPatientKey이고 STATUS가 'W'인 행의 STATUS 값을 'X'로 변경하여 접수 상태를 취소 처리합니다.\n65: 65:         \n66~71: SQL%ROWCOUNT가 0일 때 pResultCode에 -4를 할당하여 오류 상태를 표시하고, pResultMessage에 '취소할 접수 정보가 없습니다.' 메시지를 설정합니다. 그렇지 않으면 pResultMessage에 '접수가 취소되었습니다.' 메시지를 할당하여 정상 취소를 알립니다. 조건 분기(IF)와 변수 할당이 주요 동작입니다.\n72: 72:     END IF;",
          "ranges": [
            {
              "startLine": 61,
              "endLine": 72
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 61,\\n      \"endLine\": 72,\\n      \"summary\": \"pActionType이 \\'CANCEL\\'일 때 TPJ_RECEPTION 테이블에서 pReceptKey와 pPatientKey에 해당하고 STATUS가 \\'W\\'인 행의 STATUS를 \\'X\\'로 업데이트하여 접수를 취소 처리합니다. 업데이트된 행이 없으면 pResultCode에 -4를, pResultMessage에 \\'취소할 접수 정보가 없습니다.\\'를 할당하고, 성공 시 pResultMessage에 \\'접수가 취소되었습니다.\\'를 할당합니다. 조건 분기(IF), 변수 할당, UPDATE 문, SQL%ROWCOUNT 활용이 주요 동작입니다.\",\\n      \"calls\": [],\\n      \"variables\": [\\n        \"pActionType\",\\n        \"pReceptKey\",\\n        \"pPatientKey\",\\n        \"pResultCode\",\\n        \"pResultMessage\",\\n        \"SQL%ROWCOUNT\"\\n      ]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 209, 'prompt_tokens': 1520, 'total_tokens': 1729, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_144ea3b974', 'id': 'chatcmpl-CYRkYAh8G0yfu2aHf65AK92Mvpmb0', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--2d1ef5ef-4a27-439e-82de-818f69cc7b24-0' usage_metadata={'input_tokens': 1520, 'output_tokens': 209, 'total_tokens': 1729, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1520,
          "completion": 209,
          "total": 1729
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 61,
              "endLine": 72
            }
          ],
          "startLine": 61,
          "endLine": 72
        },
        "sortKey": 61
      },
      {
        "timestamp": "2025-11-06T01:45:47.463923Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "62: 62:         UPDATE TPJ_RECEPTION\n63: 63:         SET STATUS = 'X'\n64: 64:         WHERE RECEPT_KEY = pReceptKey AND PATIENT_KEY = pPatientKey AND STATUS = 'W';\n\n67: 67:             pResultCode := -4;\n\n68: 68:             pResultMessage := '취소할 접수 정보가 없습니다.';\n\n70: 70:             pResultMessage := '접수가 취소되었습니다.';",
          "ranges": [
            {
              "startLine": 62,
              "endLine": 64
            },
            {
              "startLine": 67,
              "endLine": 67
            },
            {
              "startLine": 68,
              "endLine": 68
            },
            {
              "startLine": 70,
              "endLine": 70
            }
          ],
          "count": 4,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 62,\\n      \"endLine\": 64,\\n      \"summary\": \"TPJ_RECEPTION 테이블에서 RECEPT_KEY와 PATIENT_KEY가 각각 pReceptKey, pPatientKey이고 STATUS가 \\'W\\'인 행의 STATUS 값을 \\'X\\'로 변경하여 접수 상태를 취소 처리합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pReceptKey\", \"pPatientKey\"]\\n    },\\n    {\\n      \"startLine\": 67,\\n      \"endLine\": 67,\\n      \"summary\": \"pResultCode 변수에 -4 값을 할당하여 오류 또는 특정 상태를 나타냅니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultCode\"]\\n    },\\n    {\\n      \"startLine\": 68,\\n      \"endLine\": 68,\\n      \"summary\": \"pResultMessage 변수에 \\'취소할 접수 정보가 없습니다.\\'라는 메시지를 할당하여 취소 대상이 없음을 알립니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    },\\n    {\\n      \"startLine\": 70,\\n      \"endLine\": 70,\\n      \"summary\": \"pResultMessage 변수에 \\'접수가 취소되었습니다.\\'라는 메시지를 할당하여 접수 취소 성공을 알립니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 298, 'prompt_tokens': 1491, 'total_tokens': 1789, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_144ea3b974', 'id': 'chatcmpl-CYPb1QvsPKZsJAyoCzEHRcEscfRai', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--52440a4a-d341-4394-97e5-975989d16b70-0' usage_metadata={'input_tokens': 1491, 'output_tokens': 298, 'total_tokens': 1789, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1491,
          "completion": 298,
          "total": 1789
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 62,
              "endLine": 64
            },
            {
              "startLine": 67,
              "endLine": 67
            },
            {
              "startLine": 68,
              "endLine": 68
            },
            {
              "startLine": 70,
              "endLine": 70
            }
          ],
          "startLine": 62,
          "endLine": 70
        },
        "sortKey": 62
      },
      {
        "timestamp": "2025-11-06T01:45:54.239480Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "66: 66:         IF SQL%ROWCOUNT = 0 THEN\n67~67: pResultCode 변수에 -4 값을 할당하여 오류 또는 특정 상태를 나타냅니다.\n68~68: pResultMessage 변수에 '취소할 접수 정보가 없습니다.'라는 메시지를 할당하여 취소 대상이 없음을 알립니다.\n69~70: pResultMessage 변수에 '접수가 취소되었습니다.'라는 메시지를 할당하여 접수 취소 성공을 알립니다.\n71: 71:         END IF;",
          "ranges": [
            {
              "startLine": 66,
              "endLine": 71
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 66,\\n      \"endLine\": 71,\\n      \"summary\": \"SQL%ROWCOUNT가 0일 때 pResultCode에 -4를 할당하여 오류 상태를 표시하고, pResultMessage에 \\'취소할 접수 정보가 없습니다.\\' 메시지를 설정합니다. 그렇지 않으면 pResultMessage에 \\'접수가 취소되었습니다.\\' 메시지를 할당하여 정상 취소를 알립니다. 조건 분기(IF)와 변수 할당이 주요 동작입니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"SQL%ROWCOUNT\", \"pResultCode\", \"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 145, 'prompt_tokens': 1458, 'total_tokens': 1603, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_144ea3b974', 'id': 'chatcmpl-CYRkVi2B7Et3WPVZ2X3EOlY9bXko5', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--42aa013f-fe4a-410a-9ebf-decf4f604a6c-0' usage_metadata={'input_tokens': 1458, 'output_tokens': 145, 'total_tokens': 1603, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1458,
          "completion": 145,
          "total": 1603
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 66,
              "endLine": 71
            }
          ],
          "startLine": 66,
          "endLine": 71
        },
        "sortKey": 66
      },
      {
        "timestamp": "2025-11-06T01:45:53.375575Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "69: 69:         ELSE\n70~70: pResultMessage 변수에 '접수가 취소되었습니다.'라는 메시지를 할당하여 접수 취소 성공을 알립니다.",
          "ranges": [
            {
              "startLine": 69,
              "endLine": 70
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 69,\\n      \"endLine\": 70,\\n      \"summary\": \"pResultMessage 변수에 \\'접수가 취소되었습니다.\\'라는 메시지를 할당하여 접수 취소 성공을 알립니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 75, 'prompt_tokens': 1383, 'total_tokens': 1458, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYRkTqvvMTmxeamIr4pfxeCTO8C2j', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--240e2217-61b0-437d-acaf-fb11000ee9d5-0' usage_metadata={'input_tokens': 1383, 'output_tokens': 75, 'total_tokens': 1458, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1383,
          "completion": 75,
          "total": 1458
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 69,
              "endLine": 70
            }
          ],
          "startLine": 69,
          "endLine": 70
        },
        "sortKey": 69
      },
      {
        "timestamp": "2025-11-06T01:45:55.508038Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "75: 75:     IF pActionType = 'COMPLETE' THEN\n76~78: TPJ_RECEPTION 테이블에서 RECEPT_KEY와 PATIENT_KEY가 각각 pReceptKey, pPatientKey이고 STATUS가 'W'인 행의 STATUS 값을 'C'로 갱신합니다.\n79: 79:         \n80~85: SQL%ROWCOUNT가 0이면 pResultCode에 -5를 할당하고 pResultMessage에 '완료할 접수 정보가 없습니다.'를 설정하여 처리 결과를 안내하며, 그렇지 않으면 pResultMessage에 '진료가 완료되었습니다.'를 할당합니다.\n86: 86:     END IF;",
          "ranges": [
            {
              "startLine": 75,
              "endLine": 86
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 75,\\n      \"endLine\": 86,\\n      \"summary\": \"pActionType이 \\'COMPLETE\\'일 때 TPJ_RECEPTION 테이블에서 RECEPT_KEY와 PATIENT_KEY가 각각 pReceptKey, pPatientKey이고 STATUS가 \\'W\\'인 행의 STATUS를 \\'C\\'로 갱신합니다. 갱신된 행이 없으면 pResultCode에 -5를, pResultMessage에 \\'완료할 접수 정보가 없습니다.\\'를 할당하고, 갱신이 있으면 pResultMessage에 \\'진료가 완료되었습니다.\\'를 할당합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pActionType\", \"pReceptKey\", \"pPatientKey\", \"pResultCode\", \"pResultMessage\", \"SQL%ROWCOUNT\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 186, 'prompt_tokens': 1489, 'total_tokens': 1675, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYRkfoU3caCEUhqFXWo6ILQw3Pp8z', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--20baf648-630e-4234-b9c1-260babec0b1a-0' usage_metadata={'input_tokens': 1489, 'output_tokens': 186, 'total_tokens': 1675, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1489,
          "completion": 186,
          "total": 1675
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 75,
              "endLine": 86
            }
          ],
          "startLine": 75,
          "endLine": 86
        },
        "sortKey": 75
      },
      {
        "timestamp": "2025-11-06T01:45:47.689284Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "76: 76:         UPDATE TPJ_RECEPTION\n77: 77:         SET STATUS = 'C'\n78: 78:         WHERE RECEPT_KEY = pReceptKey AND PATIENT_KEY = pPatientKey AND STATUS = 'W';\n\n81: 81:             pResultCode := -5;\n\n82: 82:             pResultMessage := '완료할 접수 정보가 없습니다.';\n\n84: 84:             pResultMessage := '진료가 완료되었습니다.';",
          "ranges": [
            {
              "startLine": 76,
              "endLine": 78
            },
            {
              "startLine": 81,
              "endLine": 81
            },
            {
              "startLine": 82,
              "endLine": 82
            },
            {
              "startLine": 84,
              "endLine": 84
            }
          ],
          "count": 4,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 76,\\n      \"endLine\": 78,\\n      \"summary\": \"TPJ_RECEPTION 테이블에서 RECEPT_KEY와 PATIENT_KEY가 각각 pReceptKey, pPatientKey이고 STATUS가 \\'W\\'인 행의 STATUS 값을 \\'C\\'로 갱신합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pReceptKey\", \"pPatientKey\"]\\n    },\\n    {\\n      \"startLine\": 81,\\n      \"endLine\": 81,\\n      \"summary\": \"pResultCode 변수에 -5 값을 할당하여 결과 코드로 오류 또는 특정 상태를 표시합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultCode\"]\\n    },\\n    {\\n      \"startLine\": 82,\\n      \"endLine\": 82,\\n      \"summary\": \"pResultMessage 변수에 \\'완료할 접수 정보가 없습니다.\\'라는 메시지를 할당하여 처리 결과 메시지를 설정합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    },\\n    {\\n      \"startLine\": 84,\\n      \"endLine\": 84,\\n      \"summary\": \"pResultMessage 변수에 \\'진료가 완료되었습니다.\\'라는 메시지를 할당하여 처리 결과 메시지를 설정합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 290, 'prompt_tokens': 1491, 'total_tokens': 1781, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYPb4kwwYZny5KWzPTqPTFfjogKhd', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--3a5a3f9d-269c-4949-ae49-e757b4f9baad-0' usage_metadata={'input_tokens': 1491, 'output_tokens': 290, 'total_tokens': 1781, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1491,
          "completion": 290,
          "total": 1781
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 76,
              "endLine": 78
            },
            {
              "startLine": 81,
              "endLine": 81
            },
            {
              "startLine": 82,
              "endLine": 82
            },
            {
              "startLine": 84,
              "endLine": 84
            }
          ],
          "startLine": 76,
          "endLine": 84
        },
        "sortKey": 76
      },
      {
        "timestamp": "2025-11-06T01:45:55.386916Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "80: 80:         IF SQL%ROWCOUNT = 0 THEN\n81~81: pResultCode 변수에 -5 값을 할당하여 결과 코드로 오류 또는 특정 상태를 표시합니다.\n82~82: pResultMessage 변수에 '완료할 접수 정보가 없습니다.'라는 메시지를 할당하여 처리 결과 메시지를 설정합니다.\n83~84: ELSE 분기에서 pResultMessage 변수에 '진료가 완료되었습니다.'라는 메시지를 할당하여 처리 결과를 안내합니다.\n85: 85:         END IF;",
          "ranges": [
            {
              "startLine": 80,
              "endLine": 85
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 80,\\n      \"endLine\": 85,\\n      \"summary\": \"SQL%ROWCOUNT가 0이면 pResultCode에 -5를 할당하고 pResultMessage에 \\'완료할 접수 정보가 없습니다.\\'를 설정하여 처리 결과를 안내하며, 그렇지 않으면 pResultMessage에 \\'진료가 완료되었습니다.\\'를 할당합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"SQL%ROWCOUNT\", \"pResultCode\", \"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 120, 'prompt_tokens': 1459, 'total_tokens': 1579, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYRkdm8dvTeDTJHDlFDKRIu3QtJJH', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--17966190-7e9e-4c47-96ec-c09df426d63b-0' usage_metadata={'input_tokens': 1459, 'output_tokens': 120, 'total_tokens': 1579, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1459,
          "completion": 120,
          "total": 1579
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 80,
              "endLine": 85
            }
          ],
          "startLine": 80,
          "endLine": 85
        },
        "sortKey": 80
      },
      {
        "timestamp": "2025-11-06T01:45:54.819655Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "83: 83:         ELSE\n84~84: pResultMessage 변수에 '진료가 완료되었습니다.'라는 메시지를 할당하여 처리 결과 메시지를 설정합니다.",
          "ranges": [
            {
              "startLine": 83,
              "endLine": 84
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 83,\\n      \"endLine\": 84,\\n      \"summary\": \"ELSE 분기에서 pResultMessage 변수에 \\'진료가 완료되었습니다.\\'라는 메시지를 할당하여 처리 결과를 안내합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 77, 'prompt_tokens': 1381, 'total_tokens': 1458, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYRkc6iN3dSOAJNO5B8ZMX3p4sjFe', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--a2794047-966e-42be-a822-cdfd01c8d567-0' usage_metadata={'input_tokens': 1381, 'output_tokens': 77, 'total_tokens': 1458, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1381,
          "completion": 77,
          "total": 1458
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 83,
              "endLine": 84
            }
          ],
          "startLine": 83,
          "endLine": 84
        },
        "sortKey": 83
      },
      {
        "timestamp": "2025-11-06T01:45:47.989935Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "88: 88:     COMMIT;\n\n93: 93:         pResultCode := -100;\n\n94: 94:         pResultMessage := SQLERRM;",
          "ranges": [
            {
              "startLine": 88,
              "endLine": 88
            },
            {
              "startLine": 93,
              "endLine": 93
            },
            {
              "startLine": 94,
              "endLine": 94
            }
          ],
          "count": 3,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 88,\\n      \"endLine\": 88,\\n      \"summary\": \"트랜잭션을 완료하기 위해 COMMIT을 실행하여 이전까지의 데이터베이스 작업을 확정합니다.\",\\n      \"calls\": [],\\n      \"variables\": []\\n    },\\n    {\\n      \"startLine\": 93,\\n      \"endLine\": 93,\\n      \"summary\": \"예외 상황에서 결과 코드 변수 pResultCode에 -100을 할당하여 오류 상태를 명시합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultCode\"]\\n    },\\n    {\\n      \"startLine\": 94,\\n      \"endLine\": 94,\\n      \"summary\": \"예외 발생 시 시스템 예외 메시지 SQLERRM을 결과 메시지 변수 pResultMessage에 저장합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultMessage\", \"SQLERRM\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 201, 'prompt_tokens': 1408, 'total_tokens': 1609, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_144ea3b974', 'id': 'chatcmpl-CYPb58RPG3lxlDD3Nlv4j45RrLU9q', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--da932d1d-347d-4248-9670-7df11f50e59c-0' usage_metadata={'input_tokens': 1408, 'output_tokens': 201, 'total_tokens': 1609, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1408,
          "completion": 201,
          "total": 1609
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 88,
              "endLine": 88
            },
            {
              "startLine": 93,
              "endLine": 93
            },
            {
              "startLine": 94,
              "endLine": 94
            }
          ],
          "startLine": 88,
          "endLine": 94
        },
        "sortKey": 88
      },
      {
        "timestamp": "2025-11-06T01:45:55.885932Z",
        "prompt": "prompt/understand_prompt.py",
        "input": {
          "code": "90: 90: EXCEPTION\n91: 91:     WHEN OTHERS THEN\n92: 92:         ROLLBACK;\n93~93: 예외 상황에서 결과 코드 변수 pResultCode에 -100을 할당하여 오류 상태를 명시합니다.\n94~94: 예외 발생 시 시스템 예외 메시지 SQLERRM을 결과 메시지 변수 pResultMessage에 저장합니다.\n95: 95: END TPX_HOSPITAL_RECEPTION;",
          "ranges": [
            {
              "startLine": 90,
              "endLine": 95
            }
          ],
          "count": 1,
          "locale": "ko"
        },
        "output": "content='{\\n  \"analysis\": [\\n    {\\n      \"startLine\": 90,\\n      \"endLine\": 95,\\n      \"summary\": \"EXCEPTION 블록에서 모든 예외 발생 시 트랜잭션을 ROLLBACK 처리하고, 결과 코드 변수 pResultCode에 -100을 할당하여 오류 상태를 명시하며, 시스템 예외 메시지 SQLERRM을 결과 메시지 변수 pResultMessage에 저장한 후 프로시저를 종료합니다.\",\\n      \"calls\": [],\\n      \"variables\": [\"pResultCode\", \"pResultMessage\"]\\n    }\\n  ]\\n}' additional_kwargs={'refusal': None} response_metadata={'token_usage': {'completion_tokens': 123, 'prompt_tokens': 1445, 'total_tokens': 1568, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_provider': 'openai', 'model_name': 'gpt-4.1-2025-04-14', 'system_fingerprint': 'fp_d38c7f4fa7', 'id': 'chatcmpl-CYRkjIlUBzw6vhxV7vJEHNRHLh2eQ', 'service_tier': 'default', 'finish_reason': 'stop', 'logprobs': None} id='lc_run--18df6e3f-6a78-48ea-a7b1-af0fa4153b63-0' usage_metadata={'input_tokens': 1445, 'output_tokens': 123, 'total_tokens': 1568, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}, 'total_cost': 0}",
        "tokenUsage": {
          "prompt": 1445,
          "completion": 123,
          "total": 1568
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 90,
              "endLine": 95
            }
          ],
          "startLine": 90,
          "endLine": 95
        },
        "sortKey": 90
      }
    ],
    "prompt/understand_dml_table_prompt.py": [
      {
        "timestamp": "2025-11-06T01:45:47.463923Z",
        "prompt": "prompt/understand_dml_table_prompt.py",
        "input": {
          "code": "23: 23:     SELECT COUNT(*) INTO vPatientExists\n24: 24:     FROM TPJ_PATIENT\n25: 25:     WHERE PATIENT_KEY = pPatientKey;",
          "ranges": [
            {
              "startLine": 23,
              "endLine": 25,
              "type": "SELECT"
            }
          ],
          "locale": "ko"
        },
        "output": {
          "tables": [
            {
              "startLine": 23,
              "endLine": 25,
              "dmlType": "SELECT",
              "table": "TPJ_PATIENT",
              "tableDescription": "환자 마스터 테이블에서 특정 환자 키의 존재 여부를 조회하여 검증합니다.",
              "columns": [
                {
                  "name": "PATIENT_KEY",
                  "dtype": "",
                  "nullable": true,
                  "description": "환자 키로 조회 조건 설정"
                }
              ],
              "fkRelations": [],
              "dbLinks": []
            }
          ]
        },
        "tokenUsage": {
          "prompt": 2924,
          "completion": 131,
          "total": 3055
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 23,
              "endLine": 25,
              "type": "SELECT"
            }
          ]
        },
        "sortKey": 23
      },
      {
        "timestamp": "2025-11-06T01:45:47.465922Z",
        "prompt": "prompt/understand_dml_table_prompt.py",
        "input": {
          "code": "36: 36:         INSERT INTO TPJ_PATIENT (PATIENT_KEY, PATIENT_NAME, BIRTH_DATE, GENDER, PHONE)\n37: 37:         VALUES (pPatientKey, pPatientName, pBirthDate, pGender, pPhone);",
          "ranges": [
            {
              "startLine": 36,
              "endLine": 37,
              "type": "INSERT"
            }
          ],
          "locale": "ko"
        },
        "output": {
          "tables": [
            {
              "startLine": 36,
              "endLine": 37,
              "dmlType": "INSERT",
              "table": "TPJ_PATIENT",
              "tableDescription": "환자 테이블에 신규 환자 정보를 삽입합니다.",
              "columns": [
                {
                  "name": "PATIENT_KEY",
                  "dtype": "",
                  "nullable": true,
                  "description": "환자 키 값을 저장"
                },
                {
                  "name": "PATIENT_NAME",
                  "dtype": "",
                  "nullable": true,
                  "description": "환자 이름을 저장"
                },
                {
                  "name": "BIRTH_DATE",
                  "dtype": "",
                  "nullable": true,
                  "description": "환자 생년월일을 저장"
                },
                {
                  "name": "GENDER",
                  "dtype": "",
                  "nullable": true,
                  "description": "환자 성별을 저장"
                },
                {
                  "name": "PHONE",
                  "dtype": "",
                  "nullable": true,
                  "description": "환자 전화번호를 저장"
                }
              ],
              "fkRelations": [],
              "dbLinks": []
            }
          ]
        },
        "tokenUsage": {
          "prompt": 2939,
          "completion": 264,
          "total": 3203
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 36,
              "endLine": 37,
              "type": "INSERT"
            }
          ]
        },
        "sortKey": 36
      },
      {
        "timestamp": "2025-11-06T01:45:47.465922Z",
        "prompt": "prompt/understand_dml_table_prompt.py",
        "input": {
          "code": "54: 54:         INSERT INTO TPJ_RECEPTION (RECEPT_KEY, PATIENT_KEY, DEPT_CODE, SYMPTOM, STATUS)\n55: 55:         VALUES (pReceptKey, pPatientKey, pDeptCode, pSymptom, 'W');",
          "ranges": [
            {
              "startLine": 54,
              "endLine": 55,
              "type": "INSERT"
            }
          ],
          "locale": "ko"
        },
        "output": {
          "tables": [
            {
              "startLine": 54,
              "endLine": 55,
              "dmlType": "INSERT",
              "table": "TPJ_RECEPTION",
              "tableDescription": "TPJ_RECEPTION 테이블에 접수 정보를 신규로 삽입합니다.",
              "columns": [
                {
                  "name": "RECEPT_KEY",
                  "dtype": "",
                  "nullable": true,
                  "description": "접수 키 값을 저장"
                },
                {
                  "name": "PATIENT_KEY",
                  "dtype": "",
                  "nullable": true,
                  "description": "환자 키 값을 저장"
                },
                {
                  "name": "DEPT_CODE",
                  "dtype": "",
                  "nullable": true,
                  "description": "진료과 코드를 저장"
                },
                {
                  "name": "SYMPTOM",
                  "dtype": "",
                  "nullable": true,
                  "description": "증상 정보를 저장"
                },
                {
                  "name": "STATUS",
                  "dtype": "",
                  "nullable": true,
                  "description": "접수 상태를 저장"
                }
              ],
              "fkRelations": [],
              "dbLinks": []
            }
          ]
        },
        "tokenUsage": {
          "prompt": 2943,
          "completion": 263,
          "total": 3206
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 54,
              "endLine": 55,
              "type": "INSERT"
            }
          ]
        },
        "sortKey": 54
      },
      {
        "timestamp": "2025-11-06T01:45:47.466923Z",
        "prompt": "prompt/understand_dml_table_prompt.py",
        "input": {
          "code": "62: 62:         UPDATE TPJ_RECEPTION\n63: 63:         SET STATUS = 'X'\n64: 64:         WHERE RECEPT_KEY = pReceptKey AND PATIENT_KEY = pPatientKey AND STATUS = 'W';",
          "ranges": [
            {
              "startLine": 62,
              "endLine": 64,
              "type": "UPDATE"
            }
          ],
          "locale": "ko"
        },
        "output": {
          "tables": [
            {
              "startLine": 62,
              "endLine": 64,
              "dmlType": "UPDATE",
              "table": "TPJ_RECEPTION",
              "tableDescription": "TPJ_RECEPTION 테이블에서 특정 접수 건의 상태를 'X'로 변경합니다.",
              "columns": [
                {
                  "name": "STATUS",
                  "dtype": "",
                  "nullable": true,
                  "description": "접수 상태를 'X'로 업데이트"
                },
                {
                  "name": "RECEPT_KEY",
                  "dtype": "",
                  "nullable": true,
                  "description": "업데이트 대상 접수 건을 식별하는 조건 컬럼"
                },
                {
                  "name": "PATIENT_KEY",
                  "dtype": "",
                  "nullable": true,
                  "description": "업데이트 대상 환자 건을 식별하는 조건 컬럼"
                }
              ],
              "fkRelations": [],
              "dbLinks": []
            }
          ]
        },
        "tokenUsage": {
          "prompt": 2936,
          "completion": 217,
          "total": 3153
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 62,
              "endLine": 64,
              "type": "UPDATE"
            }
          ]
        },
        "sortKey": 62
      },
      {
        "timestamp": "2025-11-06T01:45:47.680050Z",
        "prompt": "prompt/understand_dml_table_prompt.py",
        "input": {
          "code": "76: 76:         UPDATE TPJ_RECEPTION\n77: 77:         SET STATUS = 'C'\n78: 78:         WHERE RECEPT_KEY = pReceptKey AND PATIENT_KEY = pPatientKey AND STATUS = 'W';",
          "ranges": [
            {
              "startLine": 76,
              "endLine": 78,
              "type": "UPDATE"
            }
          ],
          "locale": "ko"
        },
        "output": {
          "tables": [
            {
              "startLine": 76,
              "endLine": 78,
              "dmlType": "UPDATE",
              "table": "TPJ_RECEPTION",
              "tableDescription": "TPJ_RECEPTION 테이블에서 특정 접수 건의 상태를 'C'로 갱신합니다.",
              "columns": [
                {
                  "name": "STATUS",
                  "dtype": "",
                  "nullable": true,
                  "description": "접수 상태를 'C'로 업데이트"
                },
                {
                  "name": "RECEPT_KEY",
                  "dtype": "",
                  "nullable": true,
                  "description": "업데이트 대상 접수 건을 조회 조건으로 사용"
                },
                {
                  "name": "PATIENT_KEY",
                  "dtype": "",
                  "nullable": true,
                  "description": "업데이트 대상 환자 건을 조회 조건으로 사용"
                }
              ],
              "fkRelations": [],
              "dbLinks": []
            }
          ]
        },
        "tokenUsage": {
          "prompt": 2936,
          "completion": 215,
          "total": 3151
        },
        "metadata": {
          "ranges": [
            {
              "startLine": 76,
              "endLine": 78,
              "type": "UPDATE"
            }
          ]
        },
        "sortKey": 76
      }
    ],
    "prompt/understand_summarized_prompt.py": [
      {
        "timestamp": "2025-11-06T01:45:56.287161Z",
        "prompt": "prompt/understand_summarized_prompt.py",
        "input": {
          "summaries": {
            "ASSIGNMENT_19_19": "pResultCode 변수에 0을 할당하여 결과 코드가 정상임을 초기화합니다.",
            "ASSIGNMENT_20_20": "pResultMessage 변수에 '성공적으로 처리되었습니다.'라는 메시지를 할당하여 기본 성공 메시지를 설정합니다.",
            "SELECT_23_25": "TPJ_PATIENT 테이블에서 PATIENT_KEY가 pPatientKey와 일치하는 행의 개수를 조회하여 vPatientExists 변수에 저장합니다.",
            "ASSIGNMENT_30_30": "pResultCode 변수에 -1을 할당하여 오류 또는 실패 상태를 표시합니다.",
            "ASSIGNMENT_31_31": "pResultMessage 변수에 '신규 환자 정보가 부족합니다.'라는 오류 메시지를 할당합니다.",
            "RETURN_32_32": "RETURN 문을 사용하여 프로시저 실행을 즉시 종료합니다.",
            "IF_29_33": "pPatientName, pBirthDate, pGender, pPhone 중 하나라도 NULL이면 pResultCode에 -1을 할당하고, pResultMessage에 '신규 환자 정보가 부족합니다.'라는 메시지를 설정한 후 RETURN으로 프로시저 실행을 즉시 종료합니다.",
            "INSERT_36_37": "TPJ_PATIENT 테이블에 pPatientKey, pPatientName, pBirthDate, pGender, pPhone 값을 신규 환자 데이터로 삽입합니다.",
            "ASSIGNMENT_39_39": "pResultCode 변수에 -2 값을 할당하여 오류 또는 특정 상태를 표시합니다.",
            "ASSIGNMENT_40_40": "pResultMessage 변수에 '존재하지 않는 환자입니다:'와 pPatientKey 값을 결합하여 오류 메시지를 설정합니다.",
            "RETURN_41_41": "RETURN 문을 통해 프로시저 또는 함수의 실행을 즉시 종료합니다.",
            "ELSIF_38_41": "vPatientExists가 0일 때, pResultCode에 -2를 할당하여 오류 상태를 표시하고, pResultMessage에 '존재하지 않는 환자입니다:'와 pPatientKey 값을 결합해 상세 오류 메시지를 설정한 후, RETURN으로 프로시저 실행을 즉시 종료합니다.",
            "IF_28_42": "vPatientExists가 0이고 pActionType이 'REGISTER'일 때 신규 환자 등록 로직을 수행합니다. pPatientName, pBirthDate, pGender, pPhone 중 하나라도 NULL이면 pResultCode에 -1, pResultMessage에 '신규 환자 정보가 부족합니다.'를 설정하고 즉시 종료합니다. 모든 정보가 있으면 TPJ_PATIENT 테이블에 pPatientKey, pPatientName, pBirthDate, pGender, pPhone을 삽입합니다. 이후에도 vPatientExists가 0이면 pResultCode에 -2, pResultMessage에 '존재하지 않는 환자입니다:'와 pPatientKey를 결합해 오류 메시지를 설정하고 즉시 종료합니다.",
            "ASSIGNMENT_47_47": "pResultCode 변수에 -3 값을 할당하여 오류 또는 특정 상태를 나타냅니다.",
            "ASSIGNMENT_48_48": "pResultMessage 변수에 '진료과 코드가 필요합니다.'라는 메시지를 할당하여 오류 원인 또는 안내 메시지를 설정합니다.",
            "RETURN_49_49": "RETURN 문을 사용하여 프로시저 또는 함수의 실행을 즉시 종료합니다.",
            "IF_46_50": "pDeptCode가 NULL인 경우 pResultCode에 -3을 할당하고, pResultMessage에 '진료과 코드가 필요합니다.'라는 안내 메시지를 설정한 뒤, RETURN으로 프로시저 실행을 즉시 종료합니다.",
            "ASSIGNMENT_52_52": "pReceptKey가 NULL인 경우 SYS_GUID() 값을 할당하여 고유 접수키를 생성합니다.",
            "INSERT_54_55": "TPJ_RECEPTION 테이블에 pReceptKey, pPatientKey, pDeptCode, pSymptom, 'W' 값을 삽입하여 진료 접수 정보를 등록합니다.",
            "ASSIGNMENT_57_57": "pResultMessage 변수에 '진료 접수가 완료되었습니다.'라는 메시지를 할당합니다.",
            "IF_45_58": "pActionType이 'REGISTER'인 경우 진료 접수 등록을 처리하며, pDeptCode가 없으면 오류 코드와 메시지를 반환하고 즉시 종료합니다. pReceptKey가 없으면 SYS_GUID()로 고유 키를 생성하고, TPJ_RECEPTION 테이블에 접수 정보를 삽입합니다. 성공 시 결과 메시지를 설정합니다.",
            "UPDATE_62_64": "TPJ_RECEPTION 테이블에서 RECEPT_KEY와 PATIENT_KEY가 각각 pReceptKey, pPatientKey이고 STATUS가 'W'인 행의 STATUS 값을 'X'로 변경하여 접수 상태를 취소 처리합니다.",
            "ASSIGNMENT_67_67": "pResultCode 변수에 -4 값을 할당하여 오류 또는 특정 상태를 나타냅니다.",
            "ASSIGNMENT_68_68": "pResultMessage 변수에 '취소할 접수 정보가 없습니다.'라는 메시지를 할당하여 취소 대상이 없음을 알립니다.",
            "ASSIGNMENT_70_70": "pResultMessage 변수에 '접수가 취소되었습니다.'라는 메시지를 할당하여 접수 취소 성공을 알립니다.",
            "ELSE_69_70": "pResultMessage 변수에 '접수가 취소되었습니다.'라는 메시지를 할당하여 접수 취소 성공을 알립니다.",
            "IF_66_71": "SQL%ROWCOUNT가 0일 때 pResultCode에 -4를 할당하여 오류 상태를 표시하고, pResultMessage에 '취소할 접수 정보가 없습니다.' 메시지를 설정합니다. 그렇지 않으면 pResultMessage에 '접수가 취소되었습니다.' 메시지를 할당하여 정상 취소를 알립니다. 조건 분기(IF)와 변수 할당이 주요 동작입니다.",
            "IF_61_72": "pActionType이 'CANCEL'일 때 TPJ_RECEPTION 테이블에서 pReceptKey와 pPatientKey에 해당하고 STATUS가 'W'인 행의 STATUS를 'X'로 업데이트하여 접수를 취소 처리합니다. 업데이트된 행이 없으면 pResultCode에 -4를, pResultMessage에 '취소할 접수 정보가 없습니다.'를 할당하고, 성공 시 pResultMessage에 '접수가 취소되었습니다.'를 할당합니다. 조건 분기(IF), 변수 할당, UPDATE 문, SQL%ROWCOUNT 활용이 주요 동작입니다.",
            "UPDATE_76_78": "TPJ_RECEPTION 테이블에서 RECEPT_KEY와 PATIENT_KEY가 각각 pReceptKey, pPatientKey이고 STATUS가 'W'인 행의 STATUS 값을 'C'로 갱신합니다.",
            "ASSIGNMENT_81_81": "pResultCode 변수에 -5 값을 할당하여 결과 코드로 오류 또는 특정 상태를 표시합니다.",
            "ASSIGNMENT_82_82": "pResultMessage 변수에 '완료할 접수 정보가 없습니다.'라는 메시지를 할당하여 처리 결과 메시지를 설정합니다.",
            "ASSIGNMENT_84_84": "pResultMessage 변수에 '진료가 완료되었습니다.'라는 메시지를 할당하여 처리 결과 메시지를 설정합니다.",
            "ELSE_83_84": "ELSE 분기에서 pResultMessage 변수에 '진료가 완료되었습니다.'라는 메시지를 할당하여 처리 결과를 안내합니다.",
            "IF_80_85": "SQL%ROWCOUNT가 0이면 pResultCode에 -5를 할당하고 pResultMessage에 '완료할 접수 정보가 없습니다.'를 설정하여 처리 결과를 안내하며, 그렇지 않으면 pResultMessage에 '진료가 완료되었습니다.'를 할당합니다.",
            "IF_75_86": "pActionType이 'COMPLETE'일 때 TPJ_RECEPTION 테이블에서 RECEPT_KEY와 PATIENT_KEY가 각각 pReceptKey, pPatientKey이고 STATUS가 'W'인 행의 STATUS를 'C'로 갱신합니다. 갱신된 행이 없으면 pResultCode에 -5를, pResultMessage에 '완료할 접수 정보가 없습니다.'를 할당하고, 갱신이 있으면 pResultMessage에 '진료가 완료되었습니다.'를 할당합니다.",
            "COMMIT_88_88": "트랜잭션을 완료하기 위해 COMMIT을 실행하여 이전까지의 데이터베이스 작업을 확정합니다.",
            "ASSIGNMENT_93_93": "예외 상황에서 결과 코드 변수 pResultCode에 -100을 할당하여 오류 상태를 명시합니다.",
            "ASSIGNMENT_94_94": "예외 발생 시 시스템 예외 메시지 SQLERRM을 결과 메시지 변수 pResultMessage에 저장합니다.",
            "EXCEPTION_90_95": "EXCEPTION 블록에서 모든 예외 발생 시 트랜잭션을 ROLLBACK 처리하고, 결과 코드 변수 pResultCode에 -100을 할당하여 오류 상태를 명시하며, 시스템 예외 메시지 SQLERRM을 결과 메시지 변수 pResultMessage에 저장한 후 프로시저를 종료합니다."
          },
          "locale": "ko"
        },
        "output": {
          "summary": "이 프로시저는 환자 등록, 진료 접수, 접수 취소, 진료 완료 등 환자 진료 프로세스의 주요 단계를 처리합니다. 입력된 환자 정보와 요청 유형(pActionType)에 따라 신규 환자 등록, 진료 접수 등록, 접수 취소, 진료 완료 처리를 수행하며, 각 단계에서 입력값 검증과 오류 메시지 반환, 성공 메시지 설정을 통해 결과를 안내합니다. 데이터베이스의 TPJ_PATIENT 및 TPJ_RECEPTION 테이블을 활용하여 환자 및 접수 정보를 관리하고, 모든 작업 후에는 트랜잭션을 커밋하거나 예외 발생 시 롤백 처리합니다. 처리 결과는 결과 코드와 메시지로 반환되어 호출자에게 현재 상태와 안내 메시지를 제공합니다."
        },
        "tokenUsage": {
          "prompt": 2299,
          "completion": 182,
          "total": 2481
        },
        "metadata": {
          "type": "procedure_summary"
        }
      }
    ],
    "prompt/understand_table_summary_prompt.py": [
      {
        "timestamp": "2025-11-06T01:45:56.505778Z",
        "prompt": "prompt/understand_table_summary_prompt.py",
        "input": {
          "table_name": "TPJ_PATIENT",
          "table_sentences": [
            "환자 마스터 테이블에서 특정 환자 키의 존재 여부를 조회하여 검증합니다.",
            "환자 테이블에 신규 환자 정보를 삽입합니다."
          ],
          "column_sentences": {
            "PATIENT_KEY": [
              "환자 키로 조회 조건 설정",
              "환자 키 값을 저장"
            ],
            "PATIENT_NAME": [
              "환자 이름을 저장"
            ],
            "BIRTH_DATE": [
              "환자 생년월일을 저장"
            ],
            "GENDER": [
              "환자 성별을 저장"
            ],
            "PHONE": [
              "환자 전화번호를 저장"
            ]
          },
          "locale": "ko"
        },
        "output": {
          "tableDescription": "TPJ_PATIENT 테이블은 환자 마스터 테이블에서 특정 환자 키의 존재 여부를 조회하거나, 신규 환자 정보를 삽입하는 데 사용됩니다.",
          "columns": [
            {
              "name": "PATIENT_KEY",
              "description": "환자 키 값을 저장하며, 조회 조건으로 사용됩니다."
            },
            {
              "name": "PATIENT_NAME",
              "description": "환자 이름을 저장합니다."
            },
            {
              "name": "BIRTH_DATE",
              "description": "환자 생년월일을 저장합니다."
            },
            {
              "name": "GENDER",
              "description": "환자 성별을 저장합니다."
            },
            {
              "name": "PHONE",
              "description": "환자 전화번호를 저장합니다."
            }
          ]
        },
        "tokenUsage": {
          "prompt": 323,
          "completion": 169,
          "total": 492
        },
        "metadata": {
          "type": "table_summary"
        }
      },
      {
        "timestamp": "2025-11-06T01:46:00.150072Z",
        "prompt": "prompt/understand_table_summary_prompt.py",
        "input": {
          "table_name": "TPJ_RECEPTION",
          "table_sentences": [
            "TPJ_RECEPTION 테이블에 접수 정보를 신규로 삽입합니다.",
            "TPJ_RECEPTION 테이블에서 특정 접수 건의 상태를 'C'로 갱신합니다.",
            "TPJ_RECEPTION 테이블에서 특정 접수 건의 상태를 'X'로 변경합니다."
          ],
          "column_sentences": {
            "RECEPT_KEY": [
              "접수 키 값을 저장",
              "업데이트 대상 접수 건을 조회 조건으로 사용",
              "업데이트 대상 접수 건을 식별하는 조건 컬럼"
            ],
            "PATIENT_KEY": [
              "업데이트 대상 환자 건을 조회 조건으로 사용",
              "업데이트 대상 환자 건을 식별하는 조건 컬럼",
              "환자 키 값을 저장"
            ],
            "DEPT_CODE": [
              "진료과 코드를 저장"
            ],
            "SYMPTOM": [
              "증상 정보를 저장"
            ],
            "STATUS": [
              "접수 상태를 저장",
              "접수 상태를 'X'로 업데이트",
              "접수 상태를 'C'로 업데이트"
            ]
          },
          "locale": "ko"
        },
        "output": {
          "tableDescription": "TPJ_RECEPTION 테이블은 접수 정보를 신규로 삽입하거나, 특정 접수 건의 상태를 'C' 또는 'X'로 갱신하는 데 사용됩니다. 주로 접수 건의 상태 변경 및 조회에 활용됩니다.",
          "columns": [
            {
              "name": "RECEPT_KEY",
              "description": "접수 키 값을 저장하며, 업데이트 대상 접수 건을 식별하는 조건 컬럼입니다."
            },
            {
              "name": "PATIENT_KEY",
              "description": "환자 키 값을 저장하며, 업데이트 대상 환자 건을 식별하는 조건 컬럼입니다."
            },
            {
              "name": "DEPT_CODE",
              "description": "진료과 코드를 저장합니다."
            },
            {
              "name": "SYMPTOM",
              "description": "증상 정보를 저장합니다."
            },
            {
              "name": "STATUS",
              "description": "접수 상태를 저장하며, 'C' 또는 'X'로 업데이트됩니다."
            }
          ]
        },
        "tokenUsage": {
          "prompt": 414,
          "completion": 215,
          "total": 629
        },
        "metadata": {
          "type": "table_summary"
        }
      }
    ]
  }
}