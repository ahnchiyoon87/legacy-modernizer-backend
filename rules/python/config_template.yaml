# Python FastAPI 설정 파일 템플릿
# 타겟: FastAPI Configuration (config.py)
# 타입: Template (LLM 호출 불필요, 순수 Jinja2 렌더링)

name: "FastAPI 설정 파일 (config.py)"
description: "FastAPI 애플리케이션의 설정 파일 템플릿"
version: "1.0"

# 템플릿 입력 파라미터
variables:
  - project_name              # 프로젝트 이름
  - db_url                    # 데이터베이스 URL (기본: postgresql://...)

# Jinja2 템플릿 (단순 변수 치환)
template: |
  import os
  from sqlalchemy import create_engine
  from sqlalchemy.orm import sessionmaker
  from sqlalchemy.ext.declarative import declarative_base

  # 환경 변수에서 설정 로드
  DATABASE_URL = os.getenv("DATABASE_URL", "{{db_url}}")

  # SQLAlchemy 엔진 생성
  engine = create_engine(
      DATABASE_URL,
      connect_args={"check_same_thread": False} if "sqlite" in DATABASE_URL else {}
  )

  # 세션 팩토리 생성
  SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

  # Base 클래스 (모든 ORM 모델의 부모)
  Base = declarative_base()

  # 애플리케이션 설정
  APP_NAME = "{{project_name}}"
  APP_VERSION = "0.1.0"
  APP_PORT = int(os.getenv("APP_PORT", 8000))
  DEBUG = os.getenv("DEBUG", "True") == "True"

  # 데이터베이스 설정
  DB_ECHO = os.getenv("DB_ECHO", "False") == "True"
